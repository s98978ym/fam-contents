# レビュー依頼機能とダッシュボードUI改善、チーム利用状況

## 何をしたか

### 1. レビュー依頼機能
- `ContentPackage`型に`review_requested_to`（依頼先ユーザー）と`review_requested_at`（依頼日時）フィールドを追加
- コンテンツ詳細ページ（`/contents/detail/[id]`）にレビュー依頼者設定プルダウンを追加
- コンテンツ作成ウィザード（Step 4: 保存・公開）にレビュー依頼者選択を追加
- `/api/contents/[id]`にGET/PATCHエンドポイントを新規作成
- サンプルデータに8件のコンテンツにレビュー依頼者情報を追加

### 2. ダッシュボードUI改善
- **レイアウト変更**: 縦長レイアウトから3カラムレイアウトに変更
  - 左カラム（3/12）: アクティブキャンペーン
  - 中央カラム（5/12）: アクティブコンテンツ（テーブル形式）
  - 右カラム（4/12）: レビュー依頼 + 最新レビュー
- **統計カード改善**: 5つのカードにリンクを追加、ホバーエフェクト付き
  - キャンペーン → /campaigns
  - コンテンツ → /contents
  - レビュー依頼 → #review-requests（ページ内リンク）
  - レビュー待ち → /reviews
  - 承認済み → /reviews
- **レビュー依頼セクション**: 自分宛てのレビュー依頼を表示、新着バッジ付き（3日以内）
- **新着表示**: ピンク色のドットで新着を可視化、アニメーション付きバッジ

### 3. チーム利用状況ダッシュボード
- `/teams/analytics` ページを新規作成
- メンバーごとの統計データを集計
  - コンテンツ作成数
  - 担当バリアント数
  - レビュー実施数（承認/修正依頼/却下）
  - コメント数（reply_toがあるレビュー）
  - レビュー依頼受信数
- CSSベースのグラフコンポーネント（外部ライブラリ不使用）
  - 棒グラフ: 総アクティビティ、コンテンツ作成、レビュー、コメント
  - 円グラフ: レビュー結果の内訳（conic-gradientで実装）
- 詳細データテーブル（メンバー別一覧、合計行付き）
- チーム管理ページに「利用状況」リンクボタンを追加

## ハマったポイント

- 特になし。既存のコード構造が整理されていたため、拡張がスムーズだった。

## 次回の注意点

- ウィザードの`StepSavePublish`コンポーネントに新しいprops（`availableUsers`, `reviewRequestedTo`, `onReviewRequestChange`）を追加したが、親コンポーネントでの実装が必要
- レビュー依頼の新着判定は現在3日以内で固定。将来的には設定可能にすることを検討
- `review_requested_to`をクリアした場合、`review_requested_at`も一緒にnullにする必要がある（API側で対応済み）
