# ナレッジ共有 - AI校正機能 & UX改善

## 実装内容

### 1. AI校正機能

ナレッジ共有の新規投稿フォームにAI校正機能を追加した。

#### 追加ファイル
- `src/app/api/knowledge/proofread/route.ts` - AI校正APIエンドポイント

#### 機能詳細

1. **「AIで校正」ボタン**
   - 内容入力欄の右上に配置
   - 内容が空の場合は無効化
   - クリックで校正を実行

2. **校正処理**
   - 冗長表現の簡潔化（「することができます」→「できます」など）
   - 句読点の正規化
   - 段落の整理
   - 箇条書きの統一
   - キーワードに基づく補足情報の追加
   - 接続詞の適切な使用
   - 全角数字を半角に統一

3. **比較表示UI**
   - 元の文章と校正後の文章を並べて表示
   - 校正後には「おすすめ」バッジを表示
   - クリックで選択可能

---

### 2. 投稿UXのカジュアル化

「投稿する」ボタンでは気軽に投稿しにくいという課題に対応。

#### UX改善ポイント

1. **QuickPostBox（フィード上部に配置）**
   - Twitter/Slack風の気軽な投稿エリア
   - ランダムなプレースホルダー（「💡 今日学んだことをシェア...」など）
   - クリックで展開、カテゴリを簡単に選択可能
   - 「シェア」ボタン（グラデーション+丸みのあるデザイン）
   - タイトルは自動生成（本文の最初の30文字）

2. **ヘッダーボタンの変更**
   - 「投稿する」→「詳細に書く」（目立たないデザインに）
   - メインの投稿導線はQuickPostBoxへ

3. **モーダルの改善**
   - 「投稿する」→「シェアする」（グラデーションボタン）
   - 「キャンセル」→「やめる」（カジュアルな表現）

4. **視覚的な工夫**
   - グラデーションボタン（青→インディゴ）
   - 丸みのあるデザイン（rounded-full）
   - シェアアイコンの追加
   - カテゴリショートカット（Tips, ハウツー, ツール, 気づき）

---

### 3. スコープ切り替え機能

投稿を「全体」「チーム」「個人」で切り替えて表示できる機能を追加。

#### UI
- ヘッダー下にタブ形式で配置
- 全体（青）/ チーム（緑）/ 自分の投稿（紫）
- チームタブには所属チーム名を表示
- ユーザー未選択時はチーム・個人タブは無効化

#### フィルタリングロジック
- **全体**: 全投稿を表示
- **チーム**: 同じチームのメンバーの投稿を表示
  - 投稿者のチームが自分と同じ
  - または投稿のteam_idが自分のチームと一致
- **個人**: 自分の投稿のみ表示

#### チームマッピング
```typescript
const USER_TEAM_MAP = {
  田中: "team_001",  // マーケティング
  佐藤: "team_001",
  鈴木: "team_002",  // コンテンツ
  山田: "team_002",
  高橋: "team_001",
};
```

## 技術ポイント

- QuickPostBoxはフィルター適用時は非表示（検索結果に集中）
- スコープ変更時もQuickPostBoxは非表示（絞り込み中の誤操作防止）
- タイトル自動生成で入力項目を削減
- 比較表示中は投稿ボタンを無効化して誤操作を防止

## 次回の注意点

- 実際のOpenAI API連携時は`simulateAIProofread`関数を置き換える
- QuickPostBoxのプレースホルダーはA/Bテストで最適化可能
- チームマッピングは実際にはAPIから取得する形に変更する
